<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{% block title %}Admin{% endblock %} - Vector Embed Cache</title>
    <meta name="csrf-token" content="{{ csrf_token }}">
    <script src="/static/js/htmx.min.js"></script>
    <script src="/static/js/frappe-charts.min.umd.js"></script>
    <link rel="stylesheet" href="/static/css/admin.css">
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            document.body.addEventListener('htmx:configRequest', function(event) {
                var csrfToken = document.querySelector('meta[name="csrf-token"]');
                if (csrfToken) {
                    event.detail.headers['X-CSRF-Token'] = csrfToken.content;
                }
            });
        });
    </script>
</head>
<body>
    {% if user %}
    <nav>
        <a href="/admin/">Dashboard</a>
        {% if user.is_admin %}<a href="/admin/users/">Users</a>{% endif %}
        <a href="/admin/keys/">API Keys</a>
        <button hx-post="/admin/logout/" hx-swap="none"
                hx-on::after-request="window.location='/admin/login/'">Logout</button>
    </nav>
    {% endif %}

    <main>
        {% if request.session.get('flash') %}
        <div class="flash {{ request.session.flash.type }}">
            {{ request.session.flash.message }}
        </div>
        {% endif %}

        {% block content %}{% endblock %}
    </main>
</body>
</html>
